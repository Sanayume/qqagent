import{A as e,C as t,D as n,E as r,F as i,M as a,O as o,P as s,T as c,_ as l,b as u,c as d,g as f,j as p,k as m,l as h,p as g,t as _,v,x as y}from"./index-DTcooqcV.js";var b={class:`h-full flex flex-col`},x={class:`flex items-center justify-between mb-4 flex-wrap gap-3`},S={class:`flex items-center gap-4`},C={class:`flex items-center gap-2 px-3 py-1 rounded-full bg-night-950 border border-gray-800`},w={class:`text-xs text-gray-400`},T={class:`flex items-center gap-3 flex-wrap`},E={class:`flex gap-1 bg-night-950 p-1 rounded-lg border border-gray-800`},D=[`onClick`],O={key:0,class:`ml-1 opacity-60`},k={key:0,class:`h-full flex flex-col items-center justify-center text-gray-600`},A={key:1,class:`h-full flex flex-col items-center justify-center text-gray-600`},j={key:2,class:`space-y-0.5`},M={class:`text-gray-600 shrink-0 select-none w-16`},N=[`title`],P={class:`text-gray-300 group-hover:text-white transition-colors break-all`},F={class:`mt-2 flex items-center justify-between text-xs text-gray-600`},I=_(c({__name:`LogsView`,setup(c){let _=d(),I=a([]),L=a(!1),R=a(!0),z=a(``),B=a(`ALL`),V=a(null),H=null,U=[`ALL`,`DEBUG`,`INFO`,`SUCCESS`,`WARNING`,`ERROR`,`CRITICAL`];function W(e){switch(e.toUpperCase()){case`DEBUG`:return`text-gray-400 bg-gray-500/10`;case`INFO`:return`text-miku-400 bg-miku-500/10`;case`SUCCESS`:return`text-green-400 bg-green-500/10`;case`WARNING`:return`text-yellow-400 bg-yellow-500/10`;case`ERROR`:return`text-red-400 bg-red-500/10`;case`CRITICAL`:return`text-red-500 font-bold bg-red-500/20`;default:return`text-gray-300 bg-gray-500/10`}}let G=l(()=>{let e=I.value;if(B.value!==`ALL`&&(e=e.filter(e=>e.level.toUpperCase()===B.value)),z.value){let t=z.value.toLowerCase();e=e.filter(e=>e.message.toLowerCase().includes(t)||e.module.toLowerCase().includes(t))}return e}),K=l(()=>{let e={};for(let t of U)t===`ALL`?e[t]=I.value.length:e[t]=I.value.filter(e=>e.level.toUpperCase()===t).length;return e});function q(){let e=`ws://localhost:8088/api/logs/stream?token=${_.token}`;console.log(`Connecting to:`,e),H=new WebSocket(e),H.onopen=()=>{L.value=!0,console.log(`WebSocket connected`)},H.onerror=e=>{console.error(`WebSocket error:`,e)},H.onclose=()=>{L.value=!1,setTimeout(q,3e3)},H.onmessage=e=>{try{let t=JSON.parse(e.data);I.value.push(t),I.value.length>2e3&&(I.value=I.value.slice(-1e3)),R.value&&J()}catch(e){console.error(`Failed to parse log:`,e)}}}function J(){r(()=>{V.value&&(V.value.scrollTop=V.value.scrollHeight)})}function Y(){I.value=[]}function X(){R.value=!R.value,R.value&&J()}async function Z(){try{await h.post(`/api/logs/test`)}catch(e){console.error(`Failed to generate test logs:`,e)}}return n(()=>{q()}),o(()=>{H&&H.close()}),(n,r)=>(m(),y(`div`,b,[v(`div`,x,[v(`div`,S,[r[1]||=v(`h1`,{class:`text-2xl font-bold text-white`},`å®æ—¶æ—¥å¿—`,-1),v(`div`,C,[v(`div`,{class:s([`w-2 h-2 rounded-full transition-colors duration-300`,L.value?`bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.6)]`:`bg-red-500 animate-pulse`])},null,2),v(`span`,w,i(L.value?`å·²è¿æ¥`:`è¿æ¥ä¸­...`),1)])]),v(`div`,T,[v(`div`,E,[(m(),y(f,null,e(U,e=>v(`button`,{key:e,onClick:t=>B.value=e,class:s([`px-2 py-1 text-xs rounded transition-all`,B.value===e?`bg-white/10 text-white font-bold`:`text-gray-500 hover:text-gray-300`])},[t(i(e)+` `,1),K.value[e]>0?(m(),y(`span`,O,`(`+i(K.value[e])+`)`,1)):u(``,!0)],10,D)),64))]),p(v(`input`,{"onUpdate:modelValue":r[0]||=e=>z.value=e,type:`text`,placeholder:`ğŸ” æœç´¢...`,class:`w-40 bg-night-950 border border-gray-700 text-gray-200 text-sm rounded-lg px-3 py-1.5 focus:border-miku-500 focus:outline-none transition-all placeholder-gray-600`},null,512),[[g,z.value]]),v(`button`,{onClick:X,class:s([`px-3 py-1.5 rounded-lg border text-xs transition-all`,R.value?`bg-miku-500/10 border-miku-500/30 text-miku-400`:`bg-night-950 border-gray-700 text-gray-400`])},` ğŸ“œ `+i(R.value?`ON`:`OFF`),3),v(`button`,{onClick:Z,class:`px-3 py-1.5 rounded-lg bg-sakura-500/10 border border-sakura-500/30 text-sakura-400 text-xs hover:bg-sakura-500/20 transition-all`},` ğŸ§ª æµ‹è¯• `),v(`button`,{onClick:Y,class:`px-3 py-1.5 rounded-lg bg-night-950 border border-gray-700 text-gray-400 text-xs hover:text-red-400 hover:border-red-500/30 transition-all`},` ğŸ—‘ï¸ `)])]),v(`div`,{ref_key:`logContainer`,ref:V,class:`flex-1 bg-night-950/80 backdrop-blur rounded-xl border border-sakura-500/10 overflow-y-auto p-4 font-mono text-xs shadow-inner custom-scrollbar`},[L.value?G.value.length===0?(m(),y(`div`,A,[r[3]||=v(`div`,{class:`text-4xl mb-4 opacity-20`},`ğŸ“`,-1),r[4]||=v(`p`,null,`æš‚æ— æ—¥å¿—æ•°æ®`,-1),v(`button`,{onClick:Z,class:`mt-4 px-4 py-2 bg-sakura-500/20 text-sakura-400 rounded-lg text-sm hover:bg-sakura-500/30 transition-colors`},` ç‚¹å‡»ç”Ÿæˆæµ‹è¯•æ—¥å¿— `)])):(m(),y(`div`,j,[(m(!0),y(f,null,e(G.value,(e,t)=>(m(),y(`div`,{key:t,class:`group hover:bg-white/5 px-2 py-1 rounded transition-colors flex items-start gap-2`},[v(`span`,M,i(e.time?.split(` `)[1]||`--:--:--`),1),v(`span`,{class:s([`shrink-0 w-16 text-center text-[10px] px-1.5 py-0.5 rounded uppercase tracking-wider`,W(e.level)])},i(e.level),3),v(`span`,{class:`text-gray-600 shrink-0 w-20 truncate text-right`,title:e.module},i(e.module?.split(`.`).pop()||`unknown`),9,N),v(`span`,P,i(e.message),1)]))),128))])):(m(),y(`div`,k,[...r[2]||=[v(`div`,{class:`w-8 h-8 border-2 border-miku-500/30 border-t-miku-500 rounded-full animate-spin mb-4`},null,-1),v(`p`,null,`æ­£åœ¨è¿æ¥æ—¥å¿—æœåŠ¡...`,-1)]]))],512),v(`div`,F,[v(`span`,null,`å…± `+i(I.value.length)+` æ¡ï¼Œæ˜¾ç¤º `+i(G.value.length)+` æ¡`,1),r[5]||=v(`span`,null,`ğŸ’¡ ç‚¹å‡» "ğŸ§ª æµ‹è¯•" æŒ‰é’®ç”Ÿæˆæ—¥å¿—éªŒè¯è¿æ¥`,-1)])]))}}),[[`__scopeId`,`data-v-6ffedf35`]]);export{I as default};